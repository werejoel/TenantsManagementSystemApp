@model TenantsManagementApp.ViewModels.Users.UserRolesEditViewModel
@{
ViewData["Title"] = "Manage User Roles";
}
<div class="container mt-2">
<div class="mx-auto" style="max-width: 1100px;">
<!-- Page header -->
<div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3 pb-2 border-bottom">
<div>
<h1 class="h4 fw-bold text-primary mb-1">
Manage Roles for <span class="text-dark">@Model.UserName</span>
</h1>
<p class="text-muted small mb-0">Assign or remove roles. Changes apply immediately after saving.</p>
</div>
<div>
<a asp-action="Details" asp-route-id="@Model.UserId" class="btn btn-dark">
<i class="bi bi-arrow-left me-1"></i> Back to Details
</a>
</div>
</div>
<div class="card shadow border-0 rounded">
<!-- Header with actions -->
<div class="card-header bg-dark text-white d-flex align-items-center justify-content-between flex-wrap gap-2">
<div class="d-flex align-items-center gap-4">
<span class="fw-semibold fs-5"><i class="bi bi-shield-lock me-2"></i>Role Assignments</span>
<div class="d-flex gap-3 align-items-center">
<span class="badge bg-info text-dark fs-6 px-3 py-2 shadow-sm rounded-pill">
<i class="bi bi-people-fill me-1"></i>Total: @Model.Roles.Count
</span>
<span class="badge bg-success fs-6 px-3 py-2 shadow-sm rounded-pill" id="selectedCount">
<i class="bi bi-check-circle-fill me-1"></i>Selected: @(Model.Roles.Count(r => r.IsSelected))
</span>
</div>
</div>
<div class="d-flex gap-2">
<button type="button" class="btn btn-success btn-sm px-3 shadow-sm" id="selectAllBtn">
<i class="bi bi-check2-square me-1"></i>Select All
</button>
<button type="button" class="btn btn-warning btn-sm px-3 shadow-sm text-dark" id="clearAllBtn">
<i class="bi bi-x-circle me-1"></i>Clear All
</button>
</div>
</div>
<div class="card-body">
<form asp-action="ManageRoles" method="post" id="rolesForm">
<input type="hidden" asp-for="UserId" />
@if (!ViewData.ModelState.IsValid && ViewData.ModelState.Values.Any(v => v.Errors.Count > 0))
{
<div class="alert alert-danger alert-dismissible fade show" role="alert">
<div class="fw-semibold mb-1">We couldn’t save your changes.</div>
<div class="small text-muted mb-2">Please review the messages below and try again.</div>
<div asp-validation-summary="All"></div>
<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
}
<!-- Roles list in two columns -->
<div class="row" id="rolesList">
@for (int i = 0; i < Model.Roles.Count; i++)
{
var roleId = $"role_{i}";
var name = Model.Roles[i].RoleName ?? "";
var desc = Model.Roles[i].Description ?? "";
<div class="col-md-6 col-lg-6 mb-3">
<label class="list-group-item rounded shadow-sm border">
<div class="d-flex align-items-start">
<input asp-for="Roles[i].IsSelected" class="form-check-input me-2 mt-1" id="@roleId" />
<div class="flex-grow-1">
<div class="fw-semibold">@name</div>
<div class="text-muted small">
@(string.IsNullOrWhiteSpace(desc) ? "No description available" : desc)
</div>
</div>
</div>
<input asp-for="Roles[i].RoleId" type="hidden" />
<input asp-for="Roles[i].RoleName" type="hidden" />
</label>
</div>
}
</div>
<!-- Actions -->
<div class="d-flex justify-content-end gap-2 mt-1">
<button type="submit" class="btn btn-primary px-4">
<i class="bi bi-save me-1"></i> Save Roles
</button>
<a asp-action="Details" asp-route-id="@Model.UserId" class="btn btn-info px-4">
Cancel
</a>
</div>
</form>
</div>
<div class="card-footer bg-light small text-muted">
Tip: “Select all” and “Clear all” apply to every role shown on this page.
</div>
</div>
</div>
</div>
@section Scripts {
<partial name="_ValidationScriptsPartial" />
<script>
(function ($) {
const $list          = $('#rolesList');
const $selectAllBtn  = $('#selectAllBtn');
const $clearAllBtn   = $('#clearAllBtn');
const $selectedCount = $('#selectedCount');
function updateSelectedCount() {
const count = $list.find('input[type="checkbox"]:checked').length;
$selectedCount.text('Selected: ' + count);
}
$selectAllBtn.on('click', function () {
$list.find('input[type="checkbox"]').prop('checked', true);
updateSelectedCount();
});
$clearAllBtn.on('click', function () {
$list.find('input[type="checkbox"]').prop('checked', false);
updateSelectedCount();
});
$list.on('change', 'input[type="checkbox"]', function () {
updateSelectedCount();
});
updateSelectedCount();
})(jQuery);
</script>
}